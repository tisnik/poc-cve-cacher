drop table if exists cve;
drop table if exists image_layer;
drop table if exists image;

create table cve (
    ID            serial primary key,
    name          text not null,
    description   text not null,
    cvss_score    numeric,
    severity      text not null
);

create table image (
    ID            serial primary key,
    digest        varchar,
    health_index  char
);

create table image_layer (
    ID            serial primary key,
    image_ID      integer not null,
    digest        varchar,
    level         numeric,

    CONSTRAINT fk_image_id
        foreign key(image_ID)
        references image(ID)
        on delete cascade
);

create unique index cve_name on cve(name);
create unique index image_digest on image(digest);
create unique index image_layer_digest on image_layer(digest);

